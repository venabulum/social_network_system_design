# System Design социальной сети для [курса по System Design](https://balun.courses/courses/system_design)

## Функциональные требования

- ФТ1. Создание поста. Пост может содержать фото, описание, геолокацию.
- ФТ2. Поставить "лайк" под постом.
- ФТ3. Написать комментарий под постом.
- ФТ4. Подписаться на путешественника.
- ФТ5. Поиск популярных мест.
- ФТ6. Просмотр постов, связанных с найденными популярными местами.
- ФТ7. Просмотр ленты постов путешественников, на которых подписан пользователь.

## Нефункциональные требования

### Общее

- НФТ1. DAU 10 000 000
- НФТ2. Аудитория — страны СНГ, поддержка только русского языка.
- НФТ3. Поддержка мобильных устройств и десктопа.
- НФТ4. Предположительная активность:
  - Запись:
    - НФТ4.1. В среднем каждый пользователь добавляет 1 пост в день.
    - НФТ4.2. В среднем каждый пользователь ставит 3 лайка в день.
    - НФТ4.3. В среднем каждый пользователь пишет 5 комментариев в день.
  - Чтение:
    - НФТ4.4. В среднем каждый пользователь просматривает 10 постов в день.
    - НФТ4.5. В среднем каждый пользователь просматривает 15 комментариев в день.
    - НФТ4.6. В среднем каждый пользователь подписывается на 7 человек в день.
    - НФТ4.7. В среднем каждый пользователь выполняет поиск популярных мест 1 раз в день.
    - НФТ4.8. В среднем каждый пользователь просматривает только одну страницу своей ленты в день.
- НФТ5. Данные храним всегда.
- НФТ6. Доступность системы 99.9%
- НФТ7. Предположительные ограничения:
    - НФТ7.1. В одном посте может быть не более одной фотографии размером до 1МБ (1024КБ).
    - НФТ7.2. В одном посте может быть описание длиной не более 600 символов (~1.1КБ).
    - НФТ7.3. Один комментарий не может превышать 300 символов (~0.5КБ).
    - НФТ7.4. Пользователь может быть подписан максимум на 1000 пользователей (и наоборот — на пользователя может быть подписано не более 1000 пользователей).
    - НФТ7.5. Пользователь может публиковать максимум 100 постов в день.
    - НФТ7.6. Пользователь может оставлять максимум 100 комментариев в день.
    - НФТ7.7. На одной странице ленты постов не более 10 постов.
    - НФТ7.8. На одной странице результатов поиска популярных мест не более 15 мест. Одно место в выдаче — это превью фотографии размером до 5КБ и короткое описание до 0.1КБ.
- НФТ8. Сезонность: в летние месяцы нагрузка увеличивается в два раза.
- НФТ9. Тайминги:
  - Запись:
    - НФТ9.1. Загрузка в пост фотографии размером 1МБ — 4 секунды.
    - НФТ9.2. Публикация поста (с предварительно загруженной в пост фотографией) — 1 секунда.
    - НФТ9.3. Публикация комментария — 1 секунда.
  - Чтение:
    - НФТ9.4. Загрузка ленты постов путешественников (до 10 постов) — 2 секунды.
    - НФТ9.5. Загрузка комментариев к посту (до 100 комментариев) — 1 секунды.
    - НФТ9.6. Поиск популярных мест — 3 секунды.

### RPS

- Посты (фото + метаданные):
  - Запись: 10000000 * 1 / 86400 = 116
  - Чтение*: 10000000 * 10 / 86400 = 1157
- Лайки: 
  - Запись: 10000000 * 3 / 86400 = 347
  - Чтение*: 10000000 * 10 / 86400 = 1157
- Комментарии:
  - Запись: 10000000 * 5 / 86400 = 579
  - Чтение: 10000000 * 15 / 86400 = 1736
- Поиск (чтение): 10000000 * 1 / 86400 = 116

### Трафик

- Посты (фото + метаданные): 
  - Запись: 116 * 1030КБ = 119480КБ/с (~117МБ/с), из них на фото 116МБ/с
  - Чтение*: 1157 * 1030КБ * 10 = 11917100КБ/с (~11.37ГБ/с), из них на фото 11.3ГБ/с
- Лайки: 
   - Запись: 347 * 0.05КБ = 17КБ/с
   - Чтение: 1157 * 0.05КБ = 58КБ/с
- Комментарии: 
  - Запись: 579 * 0.5КБ = 290КБ/с
  - Чтение: 1736 * 0.5КБ * 15 = 13020КБ/с (~13МБ/с)
- Поиск (чтение): 116 * 5.1КБ = 592КБ/с

\* считаем по количеству просматриваемых постов / страниц ленты (НФТ4.4 / НФТ4.8) с учётом количества постов в ленте на одной странице (НФТ7.7)